#light

module Sim900.Legible

// Legible paper tape characters for Elliott 900 Series

// Table of pairs of 9 bit legible character representations in collating sequence, omitting invalid
// and non-printing characters

    let codes = [|   
                    0o000000; 0o000000; 0o000000; 0o000000; 0o000000; 0o000000; 0o000000; 0o402777;
                    0o400000; 0o174202; 0o401401; 0o401202; 0o174402; 0o777400; 0o000402; 0o777400; 
                    0o000000; 0o000000; 0o000000; 0o000577; 0o040020; 0o020040; 0o040020; 0o400237;
                    0o100040; 0o020450; 0o624522; 0o441216; 0o421777; 0o777421; 0o342407; 0o205107;
                    0o040020; 0o010704; 0o502701; 0o356421; 0o451506; 0o200500; 0o004002; 0o001174;
                    0o202401; 0o401202; 0o174202; 0o104050; 0o777050; 0o104202; 0o020020; 0o020376;
                    0o020020; 0o020540; 0o340020; 0o020020; 0o020020; 0o020020; 0o600600; 0o400200;
                    0o100040; 0o020010; 0o004002; 0o001174; 0o202401; 0o401401; 0o202174; 0o402777;
                    0o400602; 0o501441; 0o421411; 0o406202; 0o401421; 0o421421; 0o356020; 0o030024;
                    0o022777; 0o020437; 0o421421; 0o421421; 0o341376; 0o421421; 0o421421; 0o342003;
                    0o401201; 0o101041; 0o021017; 0o356421; 0o421421; 0o421356; 0o216421; 0o421421;
                    0o421376; 0o606606; 0o546346; 0o020050; 0o104202; 0o401104; 0o104104; 0o104104;
                    0o104104; 0o401202; 0o104050; 0o020760; 0o000340; 0o420420; 0o340001; 0o002004;
                    0o776021; 0o021021; 0o021776; 0o777421; 0o421421; 0o421356; 0o376401; 0o401401;
                    0o401202; 0o777401; 0o401401; 0o401376; 0o777421; 0o421421; 0o401777; 0o021021;
                    0o021001; 0o376401; 0o401401; 0o441342; 0o040777; 0o020020; 0o020020; 0o777401;
                    0o777401; 0o201401; 0o401377; 0o001001; 0o001777; 0o020050; 0o104202; 0o401777;
                    0o400400; 0o400400; 0o400777; 0o002004; 0o030004; 0o002777; 0o777004; 0o010020;
                    0o040100; 0o777376; 0o401401; 0o401401; 0o401376; 0o777021; 0o021021; 0o021016;
                    0o174202; 0o401401; 0o501202; 0o574777; 0o021061; 0o121221; 0o416216; 0o421421;
                    0o421421; 0o342001; 0o001001; 0o777001; 0o001001; 0o377400; 0o400400; 0o400377;
                    0o077100; 0o200400; 0o200100; 0o077377; 0o400200; 0o100200; 0o400377; 0o603104;
                    0o050020; 0o050104; 0o603001; 0o002004; 0o770004; 0o002001; 0o601501; 0o441421;
                    0o411405; 0o403777; 0o401401; 0o401460; 0o776461; 0o461402; 0o400401; 0o401401;
                    0o777004; 0o002777; 0o002004; 0o020070; 0o124020; 0o020020; 0o020740; 0o120120;
                    0o740760; 0o520520; 0o240340; 0o420420; 0o240760; 0o420420; 0o340760; 0o520520;
                    0o420760; 0o120120; 0o020340; 0o420620; 0o640200; 0o760100; 0o100760; 0o420760;
                    0o420220; 0o420360; 0o020020; 0o760100; 0o240420; 0o760400; 0o400400; 0o760040;
                    0o100040; 0o760760; 0o040100; 0o200760; 0o340420; 0o420340; 0o760120; 0o120040;
                    0o340420; 0o620740; 0o400760; 0o120320; 0o440440; 0o520520; 0o220020; 0o020760;
                    0o020020; 0o360400; 0o400360; 0o160200; 0o400200; 0o160360; 0o400200; 0o400360;
                    0o420240; 0o100240; 0o420020; 0o040700; 0o040020; 0o420620; 0o520460; 0o420002;
                    0o001541; 0o021016; 0o023017 |]

    // table of indices into codes
    let index = [|  0;  0;  0;  0;  0;  0;  0;  0;  0;  0;  7;  7;  0;  14;   0;  14;
                    0; 14;  0; 14;  0; 14;  0; 14;  0; 14; 11; 14;  0;  32;   0;  32;
                    7; 32;  6; 40;  6; 55;  6; 70;  3; 79;  7; 85;  2;  99;   2; 108;
                    7; 119; 6; 129; 6; 141; 6; 153; 6; 166; 2; 178; 5; 182;   5; 194;
                    3; 205; 6; 214; 6; 226; 5; 237; 6; 249; 7; 258; 6; 271;   7; 284;
                    6; 298; 6; 311; 7; 323; 7; 336; 7; 350; 7; 364; 6; 375;   5; 385;
                    0; 397; 4; 401; 4; 409; 4; 417; 4; 426; 5; 433; 4; 442;   5; 451;
                    4; 460; 4; 469; 5; 477; 5; 486; 5; 496; 5; 506; 2; 516;   0; 518;
                    0; 518 |]

    // character symbols in collating sequence
    let symbols = "¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬⑩⑪¬¬¬¬ !~½$%&‘()*+,-./0123456789:;<=>❿’" +
                  "ABCDEFGHIJKLMNOPQRSTUVWXYZ[£]↑←@abcdefghijklmnopqrstuvwxyz?'__|"



